<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Week 5 Programming in C Memory Model  Array of bytes, &ldquo;Addresses&rdquo; are indexes Variables may occupy several consecutive bytes, its address refers to the first occupied byte &ldquo;Pointer&rdquo;: Variable/parameter that stores an address  int i = 69; // Suppose i was occupying bytes 45 to 74 int *p = &i // 45 Memory Regions  Text:  Stores code Pointers pointing to functions point here   Global:  Stores global variables   Stack:  Used for function calls Stores local variables Auto allocation and deallocation   Heap:  Manual allocation (malloc(), calloc()) and deallocation (free()) Used for dynamic data outside of functions    Global Variables  Two types of varaibles int pubVar = 10; // top-level public global variable int f() { static int privVar = 1010; // function private global variable  pubVar++; privVar++; ."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Week 5"><meta property="og:description" content="Week 5 Programming in C Memory Model  Array of bytes, &ldquo;Addresses&rdquo; are indexes Variables may occupy several consecutive bytes, its address refers to the first occupied byte &ldquo;Pointer&rdquo;: Variable/parameter that stores an address  int i = 69; // Suppose i was occupying bytes 45 to 74 int *p = &i // 45 Memory Regions  Text:  Stores code Pointers pointing to functions point here   Global:  Stores global variables   Stack:  Used for function calls Stores local variables Auto allocation and deallocation   Heap:  Manual allocation (malloc(), calloc()) and deallocation (free()) Used for dynamic data outside of functions    Global Variables  Two types of varaibles int pubVar = 10; // top-level public global variable int f() { static int privVar = 1010; // function private global variable  pubVar++; privVar++; ."><meta property="og:type" content="article"><meta property="og:url" content="https://navn-r.github.io/notes/CSCB09/Week-5/"><meta property="article:published_time" content="2020-06-10T17:30:31+00:00"><meta property="article:modified_time" content="2020-06-10T17:30:31+00:00"><title>Week 5 - CSCB09</title><link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@420&display=swap" rel=stylesheet><link rel=manifest href=/notes/manifest.json><link rel=icon href=/notes/favicon.png type=image/x-icon><link rel=stylesheet href=/notes/book.min.05ebbe252cb4c7ce23b9ebf0d8510e7f73238222a89b74e34ff88517b5a11fcb.css integrity="sha256-Beu+JSy0x84juevw2FEOf3MjgiKom3TjT/iFF7WhH8s="><script defer src=/notes/en.search.min.f3a2b9c36dbfd5ce1aa07d342d879f848cdefd233d2ee7759f403c4d37baebfd.js integrity="sha256-86K5w22/1c4aoH00LYefhIze/SM9Lud1n0A8TTe66/0="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/notes><span>&lt;✏️ /></span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/notes/CSCA48/>CSCA48</a><ul><li><a href=/notes/CSCA48/final-review/>Final Review</a></li></ul></li><li><a href=/notes/CSCB09/ class=collapsed>CSCB09</a><ul><li><a href=/notes/CSCB09/Week-1/>Week 1</a></li><li><a href=/notes/CSCB09/Week-2/>Week 2</a></li><li><a href=/notes/CSCB09/Week-3/>Week 3</a></li><li><a href=/notes/CSCB09/Week-4/>Week 4</a></li><li><a href=/notes/CSCB09/Week-5/ class=active>Week 5</a></li><li><a href=/notes/CSCB09/Week-6/>Week 6</a></li><li><a href=/notes/CSCB09/Week-7/>Week 7</a></li></ul></li></ul><ul><li><a href=https://github.com/navn-r/course-notes target=_blank rel=noopener>Notes Repo (Github)</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notes/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Week 5</strong>
<label for=toc-control><img src=/notes/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#programming-in-c>Programming in C</a><ul><li><a href=#memory-model>Memory Model</a></li><li><a href=#memory-regions>Memory Regions</a></li><li><a href=#global-variables>Global Variables</a></li><li><a href=#integer-types>Integer Types</a></li><li><a href=#integer-literal-notation>Integer Literal Notation</a></li><li><a href=#type-casting-with-numbers>Type Casting with Numbers</a></li><li><a href=#implicit-number-promotion>Implicit Number Promotion</a></li><li><a href=#enumeration-types>Enumeration Types</a></li><li><a href=#union-types>Union Types</a></li><li><a href=#tagged-union-idiom>Tagged Union Idiom</a></li><li><a href=#type-alias-with-typedef>Type Alias with <code>typedef</code></a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=week-5>Week 5</h1><h2 id=programming-in-c>Programming in C</h2><h3 id=memory-model>Memory Model</h3><ul><li>Array of bytes, &ldquo;Addresses&rdquo; are indexes</li><li>Variables may occupy several consecutive bytes, its address refers to the <em>first</em> occupied byte</li><li>&ldquo;Pointer&rdquo;: Variable/parameter that stores an address</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>69</span>; <span style=color:#75715e>// Suppose i was occupying bytes 45 to 74
</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#f92672>*</span>p <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>i <span style=color:#75715e>// 45
</span></code></pre></div><h3 id=memory-regions>Memory Regions</h3><ul><li>Text:<ul><li>Stores code</li><li>Pointers pointing to functions point here</li></ul></li><li>Global:<ul><li>Stores global variables</li></ul></li><li>Stack:<ul><li>Used for function calls</li><li>Stores local variables</li><li>Auto allocation and deallocation</li></ul></li><li>Heap:<ul><li>Manual allocation (<code>malloc(), calloc()</code>) and deallocation (<code>free()</code>)</li><li>Used for dynamic data outside of functions</li></ul></li></ul><h3 id=global-variables>Global Variables</h3><ul><li>Two types of varaibles<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>int</span> pubVar <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;              <span style=color:#75715e>// top-level public global variable
</span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>f</span>() {
  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> privVar <span style=color:#f92672>=</span> <span style=color:#ae81ff>1010</span>;  <span style=color:#75715e>// function private global variable
</span><span style=color:#75715e></span>  pubVar<span style=color:#f92672>++</span>;
  privVar<span style=color:#f92672>++</span>;
  ...
}
</code></pre></div></li></ul><h3 id=integer-types>Integer Types</h3><ul><li>All possible combinations: ${$<code>signed, unsigned</code>$}\times{$<code>char, short, int, long, long long</code>$}$</li><li>Byte size depends on platform<ul><li>eg. <code>x86-64</code>
| Type | Size (bytes) |
| :&mdash; | &mdash;: |
| <code>char</code> (default <code>signed</code>) | 1|
| <code>short</code> | 2 |
| <code>int</code> | 4 |
| <code>long</code> | 8 |
| <code>long long</code> | 8 |</li></ul></li></ul><h3 id=integer-literal-notation>Integer Literal Notation</h3><table><thead><tr><th align=left>Literal</th><th align=right>Type</th></tr></thead><tbody><tr><td align=left>3</td><td align=right><code>int</code></td></tr><tr><td align=left>c</td><td align=right><code>char</code></td></tr><tr><td align=left>3U</td><td align=right><code>unsigned int</code></td></tr><tr><td align=left>3L</td><td align=right><code>long</code></td></tr><tr><td align=left>3UL</td><td align=right><code>unsigned long</code></td></tr><tr><td align=left>3LL</td><td align=right><code>long long</code></td></tr><tr><td align=left>3ULL</td><td align=right><code>unsigned long long</code></td></tr></tbody></table><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C>printf(<span style=color:#e6db74>&#34;%lu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>3UL</span>) <span style=color:#75715e>// Good usage
</span><span style=color:#75715e></span>printf(<span style=color:#e6db74>&#34;%lu</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>3</span>)   <span style=color:#75715e>// Bad since 3 is `int`
</span></code></pre></div><h3 id=type-casting-with-numbers>Type Casting with Numbers</h3><ul><li>Larger size type to smaller:<ul><li>Automatic conversion</li><li>Lose some information in a natural way (<code>double</code> to <code>int</code> removes decimal place)</li><li>Better to explicitly typecast:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>double</span> d <span style=color:#f92672>=</span> <span style=color:#ae81ff>420.69</span>;
<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>)d;
</code></pre></div></li></ul></li><li>Smaller size type to larger:<ul><li>Automatic conversion</li><li>Completely lossless</li></ul></li></ul><h3 id=implicit-number-promotion>Implicit Number Promotion</h3><ul><li>The smaller operand type gets <em>promoted</em> to the larger operand type<ul><li>Note: <code>char</code> and <code>short</code> are <strong><em>always</em></strong> promoted to <code>int</code></li></ul></li><li>eg.<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#75715e>// Suppose the following
</span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> d <span style=color:#f92672>=</span> <span style=color:#ae81ff>65.0</span>;
<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>65</span>;
<span style=color:#66d9ef>char</span> c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;A&#39;</span>;
<span style=color:#75715e>/**
</span><span style=color:#75715e>i / c -&gt; promotes c to `int` and preforms integer division
</span><span style=color:#75715e>d / j -&gt; promotes j to `double` and preforms floating-point division
</span><span style=color:#75715e>**/</span>
</code></pre></div></li></ul><h3 id=enumeration-types>Enumeration Types</h3><ul><li>New &ldquo;types&rdquo; and integer constant names<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>enum</span> rps {
  ROCK,     <span style=color:#75715e>// ROCK      = 0 
</span><span style=color:#75715e></span>  PAPER,    <span style=color:#75715e>// PAPER     = 1
</span><span style=color:#75715e></span>  SCISSORS  <span style=color:#75715e>// SCISSORS  = 2
</span><span style=color:#75715e></span>};
<span style=color:#66d9ef>enum</span> coin {
  HEAD,     <span style=color:#75715e>// HEAD      = 0
</span><span style=color:#75715e></span>  TAIL      <span style=color:#75715e>// TAIL      = 1
</span><span style=color:#75715e></span>};

<span style=color:#66d9ef>enum</span> rps a <span style=color:#f92672>=</span> PAPER; <span style=color:#75715e>// a = 1
</span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> coin c <span style=color:#f92672>=</span> HEAD; <span style=color:#75715e>// c = 0
</span></code></pre></div></li><li>&ldquo;Types&rdquo; are simply <code>int</code>, are mixable and not checked</li><li>Practically useful for meaningful names only</li></ul><h3 id=union-types>Union Types</h3><ul><li>Overlapping &ldquo;fields&rdquo; that share the same space<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>union</span> myUnion { <span style=color:#75715e>// sizeof(myUnion) = &#34;largest field size&#34; = 4 (for this example)
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>short</span> s;
  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> i;
  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> b[<span style=color:#ae81ff>4</span>];
};
<span style=color:#66d9ef>union</span> myUnion u; <span style=color:#75715e>// can use u.s, u.i, u.b[j] etc.
</span></code></pre></div></li><li>Use Cases:<ul><li>High-level: Data has multiple mutually exclusive cases</li><li>Low-level:<ol><li>Store an <code>int</code> in <code>i</code></li><li>Read <code>b[0]</code> to <code>b[3]</code> to discover how <code>i</code> splits</li></ol></li></ul></li></ul><h3 id=tagged-union-idiom>Tagged Union Idiom</h3><ul><li>Example: Suppose you wanted an array that holds <strong><em>both</em></strong> <code>int</code> and <code>double</code></li><li>Idiom: Make an outer <code>struct</code><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>struct</span> int_or_double {
  <span style=color:#66d9ef>enum</span> { INT, DOUBLE } tag; <span style=color:#75715e>// remembers which case you are in
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>union</span> {                   <span style=color:#75715e>// shares the same space in memory regardless of int or double
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>int</span> i;                  <span style=color:#75715e>// case value is an int
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>double</span> d;               <span style=color:#75715e>// case value is a double
</span><span style=color:#75715e></span>  } data;
};
<span style=color:#66d9ef>struct</span> int_or_double a[<span style=color:#ae81ff>10</span>]; <span style=color:#75715e>// as wanted
</span></code></pre></div></li></ul><h3 id=type-alias-with-typedef>Type Alias with <code>typedef</code></h3><ul><li>Very general, i.e can use with <code>struct</code>, <code>enum</code>, <code>int</code>, <code>double</code> etc.<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> node {
  <span style=color:#66d9ef>int</span> i;
  <span style=color:#66d9ef>struct</span> node <span style=color:#f92672>*</span>next;
} nodetype; <span style=color:#75715e>// use `nodetype` instead of `struct node`
</span></code></pre></div></li><li>Cannot use the same <code>typedef</code> name for more than one thing<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#66d9ef>typedef</span> coin { HEAD, TAIL } coin;
<span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>int</span> coin; <span style=color:#75715e>// illegal since `typedef coin` is already defined
</span></code></pre></div></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#programming-in-c>Programming in C</a><ul><li><a href=#memory-model>Memory Model</a></li><li><a href=#memory-regions>Memory Regions</a></li><li><a href=#global-variables>Global Variables</a></li><li><a href=#integer-types>Integer Types</a></li><li><a href=#integer-literal-notation>Integer Literal Notation</a></li><li><a href=#type-casting-with-numbers>Type Casting with Numbers</a></li><li><a href=#implicit-number-promotion>Implicit Number Promotion</a></li><li><a href=#enumeration-types>Enumeration Types</a></li><li><a href=#union-types>Union Types</a></li><li><a href=#tagged-union-idiom>Tagged Union Idiom</a></li><li><a href=#type-alias-with-typedef>Type Alias with <code>typedef</code></a></li></ul></li></ul></nav></aside></main><script defer src=/notes/katex/auto-render.min.js onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false},],});"></script></body></html>